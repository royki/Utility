<?xml version='1.0' encoding='UTF-8'?>
<maven2-moduleset plugin="maven-plugin@3.0-rc2">
  <actions/>
  <description>Self Service APIs</description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <jenkins.model.BuildDiscarderProperty>
      <strategy class="hudson.tasks.LogRotator">
        <daysToKeep>30</daysToKeep>
        <numToKeep>30</numToKeep>
        <artifactDaysToKeep>-1</artifactDaysToKeep>
        <artifactNumToKeep>-1</artifactNumToKeep>
      </strategy>
    </jenkins.model.BuildDiscarderProperty>
    <org.jenkinsci.plugins.junitrealtimetestreporter.PerJobConfiguration plugin="junit-realtime-test-reporter@0.4">
      <reportInRealtime>true</reportInRealtime>
    </org.jenkinsci.plugins.junitrealtimetestreporter.PerJobConfiguration>
    <org.jenkinsci.plugins.flow__plugin.FlowProjectProperty plugin="flow@1.3"/>
  </properties>
  <scm class="hudson.plugins.git.GitSCM" plugin="git@3.6.0">
    <configVersion>2</configVersion>
    <userRemoteConfigs>
      <hudson.plugins.git.UserRemoteConfig>
        <url>https://{{}}</url>
        <credentialsId>053f30ac-0964-4af6-a695-f535e1917823</credentialsId>
      </hudson.plugins.git.UserRemoteConfig>
    </userRemoteConfigs>
    <branches>
      <hudson.plugins.git.BranchSpec>
        <name>**</name>
      </hudson.plugins.git.BranchSpec>
    </branches>
    <doGenerateSubmoduleConfigurations>false</doGenerateSubmoduleConfigurations>
    <submoduleCfg class="list"/>
    <extensions/>
  </scm>
  <assignedNode>API_ServerQA</assignedNode>
  <canRoam>false</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <jdk>(System)</jdk>
  <triggers>
    <hudson.triggers.TimerTrigger>
      <spec>H 18 * * *</spec>
    </hudson.triggers.TimerTrigger>
  </triggers>
  <concurrentBuild>false</concurrentBuild>
  <rootModule>
    <groupId>API.server</groupId>
    <artifactId>api-qa</artifactId>
  </rootModule>
  <goals>clean test</goals>
  <aggregatorStyleBuild>true</aggregatorStyleBuild>
  <incrementalBuild>false</incrementalBuild>
  <ignoreUpstremChanges>true</ignoreUpstremChanges>
  <ignoreUnsuccessfulUpstreams>false</ignoreUnsuccessfulUpstreams>
  <archivingDisabled>false</archivingDisabled>
  <siteArchivingDisabled>false</siteArchivingDisabled>
  <fingerprintingDisabled>false</fingerprintingDisabled>
  <resolveDependencies>false</resolveDependencies>
  <processPlugins>false</processPlugins>
  <mavenValidationLevel>0</mavenValidationLevel>
  <runHeadless>false</runHeadless>
  <disableTriggerDownstreamProjects>true</disableTriggerDownstreamProjects>
  <settings class="jenkins.mvn.DefaultSettingsProvider"/>
  <globalSettings class="jenkins.mvn.DefaultGlobalSettingsProvider"/>
  <reporters/>
  <publishers>
    <htmlpublisher.HtmlPublisher plugin="htmlpublisher@1.14">
      <reportTargets>
        <htmlpublisher.HtmlPublisherTarget>
          <reportName>API_ServerQA</reportName>
          <reportDir>\target\damage-control-reports\</reportDir>
          <reportFiles>index.html</reportFiles>
          <alwaysLinkToLastBuild>true</alwaysLinkToLastBuild>
          <reportTitles></reportTitles>
          <keepAll>true</keepAll>
          <allowMissing>false</allowMissing>
          <includes>**/*.html,**/*.css</includes>
        </htmlpublisher.HtmlPublisherTarget>
      </reportTargets>
    </htmlpublisher.HtmlPublisher>
    <hudson.plugins.emailext.ExtendedEmailPublisher plugin="email-ext@2.60">
      <recipientList></recipientList>
      <configuredTriggers>
        <hudson.plugins.emailext.plugins.trigger.AlwaysTrigger>
          <email>
            <subject>$PROJECT_DEFAULT_SUBJECT</subject>
            <body>$PROJECT_DEFAULT_CONTENT</body>
            <recipientProviders>
              <hudson.plugins.emailext.plugins.recipients.ListRecipientProvider/>
            </recipientProviders>
            <attachmentsPattern></attachmentsPattern>
            <attachBuildLog>false</attachBuildLog>
            <compressBuildLog>false</compressBuildLog>
            <replyTo>$PROJECT_DEFAULT_REPLYTO</replyTo>
            <contentType>project</contentType>
          </email>
        </hudson.plugins.emailext.plugins.trigger.AlwaysTrigger>
      </configuredTriggers>
      <contentType>text/html</contentType>
      <defaultSubject>API-Test</defaultSubject>
      <defaultContent>${SCRIPT,template = &quot;API_server.template&quot;}
${FILE,path=&quot;target/damage-control-reports/index.html&quot;}
</defaultContent>
      <attachmentsPattern></attachmentsPattern>
      <presendScript>$DEFAULT_PRESEND_SCRIPT</presendScript>
      <postsendScript>$DEFAULT_POSTSEND_SCRIPT</postsendScript>
      <attachBuildLog>false</attachBuildLog>
      <compressBuildLog>false</compressBuildLog>
      <replyTo>$DEFAULT_REPLYTO</replyTo>
      <saveOutput>false</saveOutput>
      <disabled>false</disabled>
    </hudson.plugins.emailext.ExtendedEmailPublisher>
  </publishers>
  <buildWrappers>
    <hudson.plugins.ws__cleanup.PreBuildCleanup plugin="ws-cleanup@0.34">
      <deleteDirs>true</deleteDirs>
      <cleanupParameter>target/</cleanupParameter>
      <externalDelete></externalDelete>
    </hudson.plugins.ws__cleanup.PreBuildCleanup>
  </buildWrappers>
  <prebuilders/>
  <postbuilders>
    <hudson.tasks.Maven>
      <targets>gplus:execute</targets>
      <mavenName>Maven3.3.9</mavenName>
      <usePrivateRepository>false</usePrivateRepository>
      <settings class="jenkins.mvn.DefaultSettingsProvider"/>
      <globalSettings class="jenkins.mvn.DefaultGlobalSettingsProvider"/>
    </hudson.tasks.Maven>
    <hudson.tasks.Maven>
      <targets>com.github.damage-control.report:damage-control-maven-plugin:report</targets>
      <mavenName>Maven3.3.9</mavenName>
      <usePrivateRepository>false</usePrivateRepository>
      <settings class="jenkins.mvn.DefaultSettingsProvider"/>
      <globalSettings class="jenkins.mvn.DefaultGlobalSettingsProvider"/>
    </hudson.tasks.Maven>
    <hudson.plugins.python.Python plugin="python@1.3">
      <command>import os
import os.path
import codecs
import re
import fileinput

#set css style for email template
def setCssStyle(file):
	oldCss=&apos;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;style/damage-control.css&quot;/&gt;&apos;
	newCss=&quot;&quot;&quot;&lt;style&gt;body{margin:0;padding:0;font-family:sans-serif;font-size:12pt}h1{font-size:150%}#footer,#navigation{font-size:small;color:#a9a9a9}a{color:#000}#content{padding:5px 30px}
    #footer{padding:30px}#footer a,#navigation a{color:#a9a9a9}.summary-group{display:inline-block;border:2px solid #D0D0D0;border-radius:10px;margin-right:10px}
    .summary-group.PASSED{color:green;border-color:green;background-color:#BBD9BB}.summary-group.FAILED{color:#B60808;border-color:#B60808;background-color:#ECDADA}
    .summary-group.SKIPPED{color:#000;border-color:#a9a9a9;background-color:#d3d3d3}.summary-counter{display:inline-block;text-align:center;padding:20px}
    .summary-counter .counter{font-weight:700;font-size:130%}#features-section table{border-bottom:solid #D0D0D0 1px;border-collapse:collapse;border-spacing:2px}
    #features-section th{border-bottom:solid #D0D0D0 1px;white-space:nowrap;text-align:right;padding-left:3em}#features-section td:first-child,#features-section
    th:first-child{padding-left:0;text-align:left}#features-section td{white-space:nowrap;padding-top:5px;padding-bottom:5px;display:table-cell;vertical-align:inherit;text-align:right}
    .result_PASSED{color:green}.result_FAILED{color:#B60808}.spec-output{font-family:monospace;font-size:large;border:1px solid #a9a9a9}
    div.details,div.steps{font-family:monospace;font-size:10pt;margin-left:10px}div.details{font-size:9pt;border-left:1px #D0D0D0 solid;padding-left:2px}
    div.steps span.PASSED{font-size:9pt;color:green}div.steps span.FAILED{font-size:9pt;color:#B60808}div.steps span.NOT_PERFORMED{font-size:9pt;color:gray}&lt;/style&gt;&quot;&quot;&quot;

	oldJs=&apos;&lt;script type=&quot;text/javascript&quot; src=&quot;js/damage-control.js&quot;&gt;&lt;/script&gt;&apos;
	newJs=&quot;&quot;&quot;&lt;script&gt;&gt;!function(){&quot;use strict&quot;;$(document).ready(function(){$(&quot;[expand]&quot;).hover(function(a){$(a.target).css(&quot;cursor&quot;,&quot;pointer&quot;),$(a.target).css(&quot;text-decoration&quot;,&quot;underline&quot;)},
    function(a){$(a.target).css(&quot;cursor&quot;,&quot;auto&quot;),$(a.target).css(&quot;text-decoration&quot;,&quot;none&quot;)}),$(&quot;[expand]&quot;).on(&quot;click&quot;,function(a){var b=$(a.target).attr(&quot;expand&quot;);$(&quot;[expandable=&quot;+b+&quot;]&quot;).toggle()}),
    $(&quot;[expandable]&quot;).hide()})}();&lt;/script&gt;&quot;&quot;&quot;
	oldJqry=&apos;&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;&apos;
	newJqry=&apos;&lt;script type=&quot;text/javascript&quot; src=&quot;https://code.jquery.com/jquery-3.1.0.min.js&quot;&gt;&lt;/script&gt;&apos;

	for line in fileinput.FileInput(file,inplace=1):
	   line = line.replace(oldCss,newCss)
	   line = line.replace(oldJs,newJs)
	   line = line.replace(oldJqry,newJqry)
	   print line


#remove packaging path from the full name
def cutClassName(file, prefix ):
	f=codecs.open(file, &apos;r&apos;)
	text = f.read()
	text = text.replace(prefix, &quot;&quot;)
	text = text.replace(&quot;Specifications&quot;, &quot;Test Results&quot;)
	text = text.replace(&quot;Specification&quot;, &quot;Use Cases&quot;)
	print text
	with open(file, &apos;w&apos;) as f:
		f.write(text)

#convert seconds to HH:MM:SS
def convertDuration(file):
	f=codecs.open(file, &apos;r&apos;)
	text = f.read()
	duration= re.search(&apos;id=&quot;specDuration&quot;&gt;(.*?)s&lt;/div&gt;&apos;, text).group(1)
	seconds= int(float(duration))
	hours = seconds // (60*60)
	seconds %= (60*60)
	minutes = seconds // 60
	seconds %= 60
	text = text.replace(duration+&quot;s&quot;, str(hours).zfill(2)+&quot;:&quot;+str(minutes).zfill(2)+&quot;:&quot;+str(seconds).zfill(2)+&quot;s&quot;)
	with open(file, &apos;w&apos;) as f:
		f.write(text)

filePath=&quot;D:\\jenkins\\workspace\\API_ServerQA\\target\\damage-control-reports\\index.html&quot;
prefix=&quot;&quot;
#Call to methods
setCssStyle(filePath)
cutClassName(filePath, prefix)
convertDuration(filePath)</command>
    </hudson.plugins.python.Python>
  </postbuilders>
  <runPostStepsIfResult>
    <name>UNSTABLE</name>
    <ordinal>1</ordinal>
    <color>YELLOW</color>
    <completeBuild>true</completeBuild>
  </runPostStepsIfResult>
</maven2-moduleset>